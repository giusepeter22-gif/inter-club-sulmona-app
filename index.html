<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0B0B0B" />
  <meta name="description" content="Inter Club Sulmona - App Soci" />

  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="icon" href="./icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="./apple-touch-icon.png" />

  <title>Inter Club Sulmona</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="topbar">
    <button id="btnLogout" class="ghost" aria-label="Esci" title="Esci" hidden>âŸµ</button>
    <div class="brand" id="brandTap">
      <img src="./icon-192.png" class="brand__logo" alt="Logo" />
      <div class="brand__text">
        <div class="brand__title" id="appTitle">Inter Club Sulmona</div>
        <div class="brand__sub" id="brandSub">App Soci</div>
      </div>
    </div>
    <div class="topbar__right"></div>
  </header>

  <main class="container">
    <!-- LOGIN -->
    <section id="viewLogin" class="card">
      <h1>Accesso Soci</h1>
      <p class="muted"><b>Benvenuto interista</b> ðŸ–¤ðŸ’™</p>
      <p class="muted">Inserisci <b>numero tessera</b> per entrare.</p>

      <label class="field">
        <span>Numero tessera</span>
        <input id="loginTessera" inputmode="text" autocapitalize="characters" autocomplete="off" placeholder="Es. S0000012345" />
      </label>


      <button id="btnLogin" class="primary">Entra</button>

      <button id="installBtn" class="secondary" hidden>ðŸ“² Scarica App</button>
      <p class="muted small">Se non entri, contatta il Club.</p>

    </section>

    <!-- HOME -->
    <section id="viewHome" hidden>
      <section class="card">
        <div class="row">
          <div>
            <h2 id="hello">Ciao ðŸ‘‹</h2>
            <p class="muted" id="memberInfo">Tessera: â€”</p>
          </div>
          <div class="points">
            <div class="points__label">Punti</div>
            <div class="points__value" id="pointsValue">0</div>
          </div>
        </div>

        <div class="grid">
          <button id="btnRefresh" class="ghost">Aggiorna</button>
        </div>
      </section>

      <section id="backendAlert" class="card card--warn" hidden></section>


      <section class="card card--blue">
        <h3>Bacheca</h3>
        <p class="muted">Comunicazioni ufficiali del Club.</p>
        <div id="bulletinBox" class="bulletin"></div>
      </section>

      <section class="card card--blue">
        <h3>Eventi</h3>
        <p class="muted">Qui trovi gli eventi del Club.</p>
        <div id="eventsList" class="list"></div>
        <p class="small muted">* Puoi prenotare <b>1 posto</b> per ogni evento.</p>
      </section>

      <section class="card card--gold">
        <h3>Quiz settimanale</h3>
        <p class="muted" id="quizTitle">Nessun quiz pubblicato</p>

        <div id="quizBox" hidden>
          <div class="divider"></div>
          <div id="quizMeta" class="row" style="margin-bottom:10px">
            <div class="pill pill--gold" id="quizStatus">Quiz attivo</div>
            <div class="pill pill--gold">+2 punti se corretto</div>
          </div>
          <div class="quiz" id="quizOptions"></div>
          <button id="btnSubmitQuiz" class="primary" disabled>Invia risposta</button>
          <div id="quizResult" class="notice" hidden></div>
          <p class="small muted" id="quizHint">Dopo la risposta non potrai piÃ¹ rispondere fino al prossimo quiz.</p>
        </div>
      </section>

      <section class="card">
        <h3>Regolamento punti</h3>
        <ul id="pointsRulesList" class="muted"></ul>
      </section>

      <section class="card ticketCard card--blue">
        <div class="ticketRow">
          <div>
            <div class="ticketTitle">Biglietteria</div>
            <div class="ticketSub muted small">Apri il link ufficiale</div>
          </div>
          <button id="btnTicket" class="ticketBtn">Biglietti Inter</button>
        </div>
      </section>

      <footer class="footer muted small">Â© Inter Club Sulmona</footer>
    </section>

    <!-- ADMIN -->
    <section id="viewAdmin" class="card" hidden>
      <div class="row">
        <h1>Admin</h1>
        <button id="btnCloseAdmin" class="ghost">Chiudi</button>
      </div>

      <div id="adminLocked">
        <p class="muted">Inserisci PIN admin.</p>
        <label class="field">
          <span>PIN</span>
          <input id="adminPin" type="password" inputmode="numeric" placeholder="PIN" />
        </label>
        <button id="btnAdminLogin" class="primary">Entra</button>
      </div>

      <div id="adminPanel" hidden>
        <h3>Impostazioni</h3>
        <div class="grid2">
          <label class="field">
            <span>Testo bottone biglietti</span>
            <input id="ticketLabel" placeholder="Biglietti Inter" />
          </label>
          <label class="field">
            <span>Link biglietti</span>
            <input id="ticketLink" placeholder="https://..." />
          </label>
        </div>
        <div class="field">
          <button id="btnSaveSettings" class="secondary">Salva impostazioni</button>
        </div>

        <div class="divider"></div>

        <h3>Regolamento punti</h3>
        <p class="muted small">Testo mostrato ai soci (una riga = un punto elenco).</p>
        <textarea id="pointsRules" rows="4" placeholder="+10 punti ogni prenotazione\nâˆ’10 punti se annulli la prenotazione\n+2 punti se rispondi correttamente al quiz"></textarea>
        <div class="field" style="margin-top:10px">
          <button id="btnSavePointsRules" class="secondary">Salva regolamento</button>
        </div>

        <div class="divider"></div>

        <h3>Bacheca</h3>
        <p class="muted small">Testo visibile a tutti i soci (vai a capo per separare le righe).</p>
        <textarea id="bulletinAdmin" rows="4" placeholder="Es. 
â€¢ Orari sede
â€¢ Trasferta: prenotazioni aperte
â€¢ Notizie importanti"></textarea>
        <div class="field" style="margin-top:10px">
          <button id="btnSaveBulletin" class="secondary">Salva bacheca</button>
        </div>

        <div class="divider"></div>

        <div class="divider"></div>

<h3>Tessere abilitate</h3>
        <p class="muted small">Una tessera per riga. Puoi anche scrivere: <b>numero, Nome Cognome</b></p>
        <textarea id="allowedList" rows="7" placeholder="000001, Mario Rossi\n000002, Luca Bianchi"></textarea>

        <div class="field" style="margin-top:10px">
          <span class="muted small">Modifica rapida (senza Excel)</span>
          <input id="allowedSearch" placeholder="Cerca tessera o nome..." />
        </div>
        <div id="allowedEditorList" class="list"></div>

        <div class="grid2">
          <label class="field">
            <span>Aggiungi tessera (numero)</span>
            <input id="addTessera" inputmode="text" autocapitalize="characters" placeholder="Es. S0000012345" />
          </label>
          <label class="field">
            <span>Nome</span>
            <input id="addNome" placeholder="Es. Mario" />
          </label>
          <label class="field">
            <span>Cognome</span>
            <input id="addCognome" placeholder="Es. Rossi" />
          </label>
          <div class="field">
            <span class="muted small">&nbsp;</span>
            <button id="btnAddMember" class="secondary">Aggiungi</button>
          </div>
        </div>

        <div class="divider"></div>

        <h3>Importa elenco soci (da Excel)</h3>
        <p class="muted small">Carica un file <b>CSV</b> esportato da Excel (consigliato). Verranno importati solo i soci <b>Attivi = SI</b> se la colonna esiste.</p>
        <label class="field">
          <span>File CSV</span>
          <input id="importCsv" type="file" accept=".csv,text/csv" />
        </label>
        <label class="field" style="margin-top:6px">
          <span class="muted small">Opzione import</span>
          <select id="importMode">
            <option value="replace">Sostituisci elenco (consigliato)</option>
            <option value="merge">Aggiungi/Unisci allâ€™elenco attuale</option>
          </select>
        </label>
        <div class="grid">
          <button id="btnImportCsv" class="primary">Importa CSV</button>
        </div>
        <div class="grid">
          <button id="btnSaveAllowed" class="primary">Salva tessere</button>
          <button id="btnExport" class="ghost">Esporta dati</button>
        </div>

        <div class="divider"></div>
        <h3>Soci (anteprima)</h3>
        <p class="muted small">Qui vedi tessera e nome (i nomi vengono salvati dopo il primo accesso o da lista tessere).</p>
        <div id="memberList" class="list"></div>

        <div class="divider"></div>

        <h3>Classifica punti fedeltÃ </h3>
        <p class="muted small">Classifica automatica (dal piÃ¹ alto al piÃ¹ basso).</p>
        <div class="grid" style="margin-bottom:8px">
          <button id="btnResetAllPoints" class="danger">Azzerare punti a tutti</button>
        </div>
        <div id="leaderboardList" class="list"></div>

        <div class="divider"></div>

        <h3>Prenotazioni evento</h3>
        <p class="muted small">Seleziona un evento per vedere chi ha prenotato (1 posto a socio).</p>
        <label class="field">
          <span>Evento</span>
          <select id="bookingEventSelect"></select>
        </label>
        <div id="bookingList" class="list"></div>

        <div class="divider"></div>

        <h3>Crea nuovo evento</h3>
        <div class="grid2">
          <label class="field">
            <span>Titolo evento</span>
            <input id="eventAdminTitle" placeholder="Es. Inter - Milan" />
          </label>
          <label class="field">
            <span>Data/Ora (testo)</span>
            <input id="eventAdminDate" placeholder="Es. Sab 20:45" />
          </label>
        </div>
        <div class="grid2">
          <label class="field">
            <span>Posti totali</span>
            <input id="eventAdminCapacity" inputmode="numeric" placeholder="40" />
          </label>
          <label class="field">
            <span>Nota (opzionale)</span>
            <input id="eventAdminNote" placeholder="Es. Arrivare 30 min prima" />
          </label>
        </div>
        <div class="grid">
          <button id="btnPublishEvent" class="primary">Crea evento</button>
          <button id="btnClearEvent" class="danger">Elimina evento selezionato</button>
        </div>

        <label class="field" style="margin-top:10px">
          <span>Eventi creati</span>
          <select id="eventAdminSelect"></select>
        </label>

        <h3>Quiz</h3>
        <label class="field">
          <span>Domanda</span>
          <input id="quizQ" placeholder="Es. Chi ha segnato di piÃ¹ nel 2025?" />
        </label>
        <div class="grid2">
          <label class="field"><span>Opzione A</span><input id="quizA" /></label>
          <label class="field"><span>Opzione B</span><input id="quizB" /></label>
          <label class="field"><span>Opzione C</span><input id="quizC" /></label>
          <label class="field"><span>Opzione D</span><input id="quizD" /></label>
        </div>
        <label class="field">
          <span>Risposta corretta (A/B/C/D)</span>
          <input id="quizCorrect" maxlength="1" placeholder="A" />
        </label>

        <div class="grid">
          <button id="btnPublishQuiz" class="primary">Pubblica nuovo quiz</button>
          <button id="btnClearQuiz" class="danger">Rimuovi quiz</button>
        </div>

        <p class="small muted">Quando pubblichi un nuovo quiz, tutti potranno rispondere <b>una sola volta</b>.</p>
      </div>
    </section>
  </main>

  <div id="toast" class="toast" hidden></div>

  <script src="./app.js"></script>
</body>
</html>
